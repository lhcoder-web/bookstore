(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15de2e8c"],{"0908":function(t,n,i){},"0a02":function(t,n,i){"use strict";var a=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("transition",{attrs:{name:"fade"}},[t.isPlaying?i("div",{staticClass:"speak-window"},[i("div",{staticClass:"text-wrapper"},[t._v(" "+t._s(t.text))])]):t._e()])},e=[],o={props:{text:String,isPlaying:Boolean}},r=o,s=(i("ccb3"),i("2877")),c=Object(s["a"])(r,a,e,!1,null,"75c3415c",null);n["a"]=c.exports},3111:function(t,n,i){"use strict";var a=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"bottom-wrapper",class:{"hide-play":!t.showPlay}},[t.showPlay?i("div",{staticClass:"bottom-playing-wrapper",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.onPlayingCardClick(n)}}},[i("div",{staticClass:"bottom-playing-left"},[i("div",{staticClass:"icon-play-wrapper",on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.togglePlay(n)}}},[t.isPlaying?i("span",{staticClass:"icon-play_pause"}):i("span",{staticClass:"icon-play_go"})])]),i("div",{staticClass:"bottom-playing-right"},[i("div",{staticClass:"bottom-playing-chapter-text"},[i("span",{staticClass:"chapter-label"},[t._v(t._s(t.chapter?t.chapter.label:""))]),t.currentSectionIndex&&t.currentSectionTotal?i("span",{staticClass:"bottom-playing-page-text"},[t._v("( "+t._s(t.currentSectionIndex)+" / "+t._s(t.currentSectionTotal)+" )")]):t._e()]),i("div",{staticClass:"bottom-playing-page-text"},[t._v(t._s(t.playInfo?t.playInfo.currentMinute:"00")+":"+t._s(t.playInfo?t.playInfo.currentSecond:"00")+" / "+t._s(t.playInfo?t.playInfo.totalMinute:"00")+":"+t._s(t.playInfo?t.playInfo.totalSecond:"00"))])])]):t._e()])},e=[],o=(i("a9e3"),{props:{chapter:Object,currentSectionIndex:Number,currentSectionTotal:Number,showPlay:Boolean,isPlaying:Boolean,playInfo:Object},methods:{togglePlay:function(){this.$parent.togglePlay()},onPlayingCardClick:function(){this.$emit("onPlayingCardClick")}}}),r=o,s=(i("aa0e"),i("2877")),c=Object(s["a"])(r,a,e,!1,null,"57aa28b3",null);n["a"]=c.exports},"35c1":function(t,n,i){},5319:function(t,n,i){"use strict";var a=i("d784"),e=i("825a"),o=i("7b0b"),r=i("50c4"),s=i("a691"),c=i("1d80"),l=i("8aa5"),u=i("14c3"),d=Math.max,p=Math.min,f=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g,g=function(t){return void 0===t?t:String(t)};a("replace",2,(function(t,n,i,a){var y=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=a.REPLACE_KEEPS_$0,m=y?"$":"$0";return[function(i,a){var e=c(this),o=void 0==i?void 0:i[t];return void 0!==o?o.call(i,e,a):n.call(String(e),i,a)},function(t,a){if(!y&&b||"string"===typeof a&&-1===a.indexOf(m)){var o=i(n,t,this,a);if(o.done)return o.value}var c=e(t),f=String(this),h="function"===typeof a;h||(a=String(a));var v=c.global;if(v){var P=c.unicode;c.lastIndex=0}var w=[];while(1){var C=u(c,f);if(null===C)break;if(w.push(C),!v)break;var S=String(C[0]);""===S&&(c.lastIndex=l(f,r(c.lastIndex),P))}for(var x="",_=0,I=0;I<w.length;I++){C=w[I];for(var T=String(C[0]),$=d(p(s(C.index),f.length),0),M=[],O=1;O<C.length;O++)M.push(g(C[O]));var E=C.groups;if(h){var j=[T].concat(M,$,f);void 0!==E&&j.push(E);var A=String(a.apply(void 0,j))}else A=k(T,f,$,M,E,a);$>=_&&(x+=f.slice(_,$)+A,_=$+T.length)}return x+f.slice(_)}];function k(t,i,a,e,r,s){var c=a+t.length,l=e.length,u=v;return void 0!==r&&(r=o(r),u=h),n.call(s,u,(function(n,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return i.slice(0,a);case"'":return i.slice(c);case"<":s=r[o.slice(1,-1)];break;default:var u=+o;if(0===u)return n;if(u>l){var d=f(u/10);return 0===d?n:d<=l?void 0===e[d-1]?o.charAt(1):e[d-1]+o.charAt(1):n}s=e[u-1]}return void 0===s?"":s}))}}))},"8b38":function(t,n,i){},9315:function(t,n,i){"use strict";var a=i("0908"),e=i.n(a);e.a},"9fa9":function(t,n,i){"use strict";(function(t){i("a4d3"),i("e01a"),i("99af"),i("4de4"),i("4160"),i("ac1f"),i("5319"),i("159b");var a=i("1432"),e=i("c470"),o=i("6701"),r=i("c4f7"),s=i("3111"),c=i("0a02"),l=i("da6f"),u=i("1ae0"),d=i("101f"),p=i("fa7d"),f=i("bb38"),h=i("ac0d");t.ePub=f["a"];n["a"]={mixins:[h["d"]],components:{DetailTitle:a["a"],BookInfo:e["a"],Scroll:o["a"],SpeakPlaying:r["a"],Bottom:s["a"],speakWindow:c["a"]},computed:{currentMinute:function(){var t=Math.floor(this.currentPlayingTime/60);return t<10?"0"+t:t},currentSecond:function(){var t=Math.floor(this.currentPlayingTime-60*parseInt(this.currentMinute));return t<10?"0"+t:t},totalMinute:function(){var t=Math.floor(this.totalPlayingTime/60);return t<10?"0"+t:t},totalSecond:function(){var t=Math.floor(this.totalPlayingTime-60*parseInt(this.totalMinute));return t<10?"0"+t:t},leftMinute:function(){var t=Math.floor((this.totalPlayingTime-this.currentPlayingTime)/60);return t<10?"0"+t:t},leftSecond:function(){var t=Math.floor(this.totalPlayingTime-this.currentPlayingTime-60*parseInt(this.leftMinute));return t<10?"0"+t:t},playInfo:function(){return this.audioCanPlay?{currentMinute:this.currentMinute,currentSecond:this.currentSecond,totalMinute:this.totalMinute,totalSecond:this.totalSecond,leftMinute:this.leftMinute,leftSecond:this.leftSecond}:null},showPlay:function(){return this.playingIndex>=0},scrollBottom:function(){return this.showPlay?116:52},chapter:function(){return this.flatNavigation[this.playingIndex]},desc:function(){return this.description?this.description.substring(0,100):""},flatNavigation:function(){return this.navigation?Array.prototype.concat.apply([],Array.prototype.concat.apply([],this.doFlatNavigation(this.navigation.toc))):[]},category:function(){return this.bookItem?Object(l["e"])(this.bookItem.category):""},title:function(){return this.metadata?this.metadata.title:""},author:function(){return this.metadata?this.metadata.creator:""}},data:function(){return{bookItem:null,book:null,rendition:null,metadata:null,cover:null,navigation:null,description:null,ifShowContent:!0,playingIndex:-1,paragraph:null,currentSectionIndex:null,currentSectionTotal:null,section:null,isPlaying:!1,audio:null,audioCanPlay:!1,currentPlayingTime:0,totalPlayingTime:0,playStatus:0,toastText:"",isOnline:!1,text:""}},methods:{togglePlay:function(){this.isPlaying?this.pausePlay():this.play()},speak:function(t,n){var i=this;this.playingIndex=n,this.$nextTick((function(){i.$refs.scroll.refresh(),i.chapter&&(i.section=i.book.spine.get(i.chapter.href),i.rendition.display(i.section.href).then((function(t){var n=i.rendition.currentLocation(),a=t.cfiBase,e=n.start.cfi.replace(/.*!/,"").replace(/\)/,""),o=n.end.cfi.replace(/.*!/,"").replace(/\)/,"");i.currentSectionIndex=n.start.displayed.page,i.currentSectionTotal=n.start.displayed.total;var r="epubcfi(".concat(a,"!,").concat(e,",").concat(o,")");i.book.getRange(r).then((function(t){var n=t.toLocaleString();n=n.replace(/\s(2,)/g,""),n=n.replace(/\r/g,""),n=n.replace(/\n/g,""),n=n.replace(/\t/g,""),n=n.replace(/\f/g,""),i.text=n,console.log(i.text)}))})))}))},play:function(){this.$refs.audio.src="http://tsn.baidu.com/text2audio?lan=zh&ctp=1&cuid=abcdxxx&tok=24.e4587a8b118fc0812c8a072224a02b5f.2592000.1587790204.282335-19088134&tex=".concat(this.text),this.$refs.audio.play(),this.isPlaying=!0},pausePlay:function(){this.$refs.audio.pause(),this.$refs.speakPlaying[0].stopAnimation(),this.isPlaying=!1},onAudioEnded:function(){this.currentPlayingTime=this.$refs.audio.currentTime;Math.floor(this.currentPlayingTime/this.totalPlayingTime*100)},onTimeUpdate:function(){this.currentPlayingTime=this.$refs.audio.currentTime;Math.floor(this.currentPlayingTime/this.totalPlayingTime*100)},onCanPlay:function(){this.audioCanPlay=!0,this.currentPlayingTime=this.$refs.audio.currentTime,this.totalPlayingTime=this.$refs.audio.duration},findBookFromList:function(t){var n=this;Object(u["c"])().then((function(i){if(200===i.status){var a=i.data.data.filter((function(n){return n.fileName===t}));a&&a.length>0&&(n.bookItem=a[0],n.init())}}))},init:function(){var t=this,n=this.$route.query.fileName;this.bookItem||(this.bookItem=Object(l["d"])(n)),this.bookItem?Object(d["b"])(n,(function(n,i){if(n||!i){t.isOnline=!0;var a=t.$route.query.opf;a&&t.parseBook(a)}else t.isOnline=!1,t.parseBook(i)})):this.findBookFromList(n)},parseBook:function(t){var n=this;this.book=new f["a"](t),this.book.loaded.metadata.then((function(t){n.metadata=t})),this.isOnline?this.book.coverUrl().then((function(t){n.cover=t})):this.book.loaded.cover.then((function(t){n.book.archive.createUrl(t).then((function(t){n.cover=t}))})),this.book.loaded.navigation.then((function(t){n.navigation=t})),this.display()},back:function(){this.$router.go(-1)},onScroll:function(t){t>Object(p["b"])(42)?this.$refs.title.showShadow():this.$refs.title.hideShadow()},toggleContent:function(){this.ifShowContent=!this.ifShowContent},display:function(){var t=.9*window.innerHeight-Object(p["b"])(40)-Object(p["b"])(54)-Object(p["b"])(46)-Object(p["b"])(48)-Object(p["b"])(60)-Object(p["b"])(44);this.rendition=this.book.renderTo("read",{width:window.innerWidth,height:t,method:"default"}),this.rendition.display()},doFlatNavigation:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=[];return t.forEach((function(t){t.deep=i,a.push(t),t.subitems&&t.subitems.length>0&&a.push(n.doFlatNavigation(t.subitems,i+1))})),a},showToast:function(t){this.simpleToast(t)},updateText:function(t){this.paragraph=t}},mounted:function(){this.init(),this.setTabbarVisible(!1)}}}).call(this,i("c8ba"))},aa0e:function(t,n,i){"use strict";var a=i("c21f"),e=i.n(a);e.a},c21f:function(t,n,i){},c470:function(t,n,i){"use strict";var a=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"cover-title-wrapper"},[i("div",{staticClass:"cover-title-left-wrapper"},[i("img",{staticClass:"cover-img",attrs:{src:t.cover}})]),i("div",{staticClass:"cover-title-right-wrapper"},[i("div",{staticClass:"detail-cover-title-wrapper"},[i("div",{staticClass:"cover-title-text"},[t._v(t._s(t.title))])]),i("div",{staticClass:"cover-author-wrapper"},[i("div",{staticClass:"cover-author-text"},[t._v(t._s(t.author))])]),i("div",{staticClass:"detail-cover-description-wrapper"},[i("div",{staticClass:"detail-cover-description-text"},[t._v(t._s(t.desc))])])])])},e=[],o={props:{cover:String,title:String,author:String,desc:String}},r=o,s=(i("cbbc"),i("2877")),c=Object(s["a"])(r,a,e,!1,null,"da3f5996",null);n["a"]=c.exports},c4f7:function(t,n,i){"use strict";var a=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"playing-item-wrapper"},t._l(t.styles,(function(t,n){return i("div",{key:n,ref:"playingItem",refInFor:!0,staticClass:"playing-item",style:t})})),0)},e=[],o=(i("4160"),i("a9e3"),i("159b"),i("fa7d")),r={props:{number:Number},computed:{styles:function(){for(var t=new Array(this.number),n=0;n<t.length;n++)t[n]={height:Object(o["a"])(this.random())+"rem"};return t}},methods:{startAnimation:function(){var t=this;this.task=setInterval((function(){t.$refs.playingItem.forEach((function(n){n.style.height=Object(o["a"])(t.random())+"rem"}))}),200)},stopAnimation:function(){this.task&&clearInterval(this.task)},random:function(){return Math.ceil(10*Math.random())}}},s=r,c=(i("ed62"),i("2877")),l=Object(c["a"])(s,a,e,!1,null,"9511d836",null);n["a"]=l.exports},cbbc:function(t,n,i){"use strict";var a=i("8b38"),e=i.n(a);e.a},ccb3:function(t,n,i){"use strict";var a=i("dff7"),e=i.n(a);e.a},dff7:function(t,n,i){},ed62:function(t,n,i){"use strict";var a=i("35c1"),e=i.n(a);e.a},f609:function(t,n,i){"use strict";i.r(n);var a=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"book-speaking"},[i("detail-title",{ref:"title",on:{back:t.back}}),i("scroll",{ref:"scroll",staticClass:"content-wrapper",attrs:{top:42,bottom:0},on:{onScroll:t.onScroll}},[i("book-info",{attrs:{cover:t.cover,title:t.title,author:t.author,desc:t.desc}}),i("div",{staticClass:"book-speak-title-wrapper"},[i("div",{staticClass:"icon-speak-wrapper"},[i("span",{staticClass:"icon-speak"})]),i("div",{staticClass:"speak-title-wrapper"},[i("span",{staticClass:"speak-title"},[t._v("语言朗读")])]),i("div",{staticClass:"icon-down-wrapper",on:{click:t.toggleContent}},[i("span",{class:{"icon-down2":!t.ifShowContent,"icon-up":t.ifShowContent}})])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.ifShowContent,expression:"ifShowContent"}],staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-list-wrapper"},[this.navigation?t._e():i("div",{staticClass:"loading-text-wrapper"},[i("span",{staticClass:"loading-text"},[t._v("详情加载")])]),i("div",{staticClass:"book-detail-content-item-wrapper"},t._l(t.flatNavigation,(function(n,a){return i("div",{key:a,staticClass:"book-detail-content-item",on:{click:function(i){return t.speak(n,a)}}},[t.playingIndex===a?i("speak-playing",{ref:"speakPlaying",refInFor:!0,attrs:{number:5}}):t._e(),n.label?i("div",{staticClass:"book-detail-content-navigation-text",class:{"is-playing":t.playingIndex===a}},[t._v(t._s(n.label)+" ")]):t._e()],1)})),0)])]),i("audio",{ref:"audio",on:{canplay:t.onCanPlay,timeupdate:t.onTimeUpdate,ended:t.onAudioEnded}})],1),i("bottom",{attrs:{chapter:t.chapter,currentSectionIndex:t.currentSectionIndex,currentSectionTotal:t.currentSectionTotal,showPlay:t.showPlay,isPlaying:t.isPlaying,playInfo:t.playInfo},on:{"update:isPlaying":function(n){t.isPlaying=n},"update:is-playing":function(n){t.isPlaying=n}}}),i("speak-window",{attrs:{text:t.text,isPlaying:t.isPlaying},on:{"update:isPlaying":function(n){t.isPlaying=n},"update:is-playing":function(n){t.isPlaying=n}}}),t._m(0)],1)},e=[function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"book-wrapper"},[i("div",{attrs:{id:"read"}})])}],o=i("9fa9"),r=o["a"],s=(i("9315"),i("2877")),c=Object(s["a"])(r,a,e,!1,null,"e3988b30",null);n["default"]=c.exports}}]);
//# sourceMappingURL=chunk-15de2e8c.82e15242.js.map